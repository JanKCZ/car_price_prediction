<!DOCTYPE html>
<html lang="cs">
<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-NF6KVBFX79"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'G-NF6KVBFX79');
	</script>
	<meta name="description" content="Na této stránce odhadujeme standardní cenu automobilu na trhu s využitím neuronové sítě. Neuronová síť je forma strojového učení, která umožnila prozkoumat více jak 90 tisíc inzerátů automobilů. 
	Pomocí těchto dat bylo vytvořeno spolehlivé srovnání ceny automobilu s podobnými automobily.">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta charset="UTF8">
	<title>Odhad ceny automobilu</title>
	<script type="text/javascript"
         src="{{ url_for('static', filename='data.js') }}">
    </script>
    <script type="text/javascript"
         src="{{ url_for('static', filename='methods.js') }}">
    </script>
    <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/style.css') }}"/>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
</head>
<body>
	<!-- Custom tracking evenets -->
	<script>
		dataLayer = [{
		  'pageCategory': 'signup',
		  'visitorType': 'high-value'
		}];
	</script>
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-NF6KVBFX79"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
	<div class="container">
		<br>
	<header>
		<center>
			<h1>
				<u style="text-decoration-thickness: 1px; text-underline-offset: 10px;">Odhad tržní ceny automobilu</u>
			</h1>
		</center>
			<b1 id="headline_text">
				Na této stránce odhadujeme standardní cenu automobilu na trhu. Cenu automobilu je možné určit na základě 13 parametrů, které jsou poté použity pro odhad 
				pomocí neuronové sítě. Neuronová síť je forma strojového učení, která umožnila prozkoumat více jak 90 tisíc inzerátů automobilů. 
				Pomocí těchto dat bylo vytvořeno spolehlivé srovnání ceny automobilu s podobnými automobily na trhu.
				Tento projekt vznikl jako prezentace využití strojového učení.
			</b1>
			<br><br>

	</header>
	<main>
	<center>
		<h1 id="pred" style="color: green;">
			{{pred_text}}<br>
			{{pred_price}}
		</h1>
		<br>
		<form>
			<div class="row">
				<div class="col-sm">
				<select
							class="form-select form-select-lg mb-3" id="car_brand_list" style="width:300px; height: 48px;">
							<option value="" disabled selected>výrobce</option>
				</select>
				</div>
				<div class="col-sm">
				<select 
							class="form-select form-select-lg mb-3" id="car_model_list" style="width:300px; height: 48px;">
							<option value="" disabled selected>model</option>
				</select>
				</div>
				<div class="col-sm">
				<select 
							class="form-select form-select-lg mb-3" id="car_type_list" style="width:300px; height: 48px;">
							<option value="" disabled selected>karoserie</option>
				</select>
				</div>
			</div>
			<div class="row">
				<div class="col-sm">
				<select 
							class="form-select form-select-lg mb-3" id="condition" style="width:300px; height: 48px;">
							<option disabled selected value >stav vozu</option>
							<option value="nové">Nové</option>
							<option value="předváděcí">Předváděcí</option>
							<option value="ojeté">Ojeté</option>
				</select>
				</div>
				<div class="col-sm">
				<select 
							class="form-select form-select-lg mb-3" id="book" style="width:300px; height: 48px;">
							<option disabled selected value >servisní knížka</option>
							<option value="ano">Ano</option>
							<option value="ne">Ne</option>
				</select>
				</div>
				<div class="col-sm">
					<select 
						class="form-select form-select-lg mb-3" id="car_fuel_list" style="width:300px; height: 48px;">
						<option value="" disabled selected>palivo</option>
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-sm">
				<select 
							class="form-select form-select-lg mb-3" id="air_condition_list" style="width:300px; height: 48px;">
							<option value="" disabled selected>klimatizace</option>
				</select>
				</div>
				<div class="col-sm">
				<select 
							class="form-select form-select-lg mb-3" id="transmission_list" style="width:300px; height: 48px;">
							<option value="" disabled selected>převodovka</option>
				</select>
				</div>
				<div class="col-sm">
				<select 
							class="form-select form-select-lg mb-3" id="country_list" style="width:300px; height: 48px;">
							<option value="" disabled selected>země původu</option>
				</select>
				</div>
			</div>	
			<div class="row">
				<div class="col-sm">
					<div class="mb-3">
						<label for="exampleFormControlInput1" class="form-label">Rok výroby (min 2000)</label>
						<input type="number" id="year" name="year" class="form-control" style="width:300px;" min = 2000 max = 2021 equired minlength="4" maxlength="4" placeholder="např. 2015" onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))">
					</div>
				</div>
				<div class="col-sm">
					<div class="mb-3">
						<label for="exampleFormControlInput1" class="form-label">Počet dveří</label>
						<input type="number" id="n_doors_list" name="n_doors_list" class="form-control" style="width:300px;" min = 1 max = 9 required minlength="1" maxlength="1" placeholder="počet dveří" onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))">
					</div>
				</div>
				<div class="col-sm">
					<div class="mb-3">
						<label for="exampleFormControlInput1" class="form-label">Výkon motoru v kW</label>
						<input type="number" id="engine_power" name="engine_power" class="form-control" style="width:300px;" min = 0 max = 999 required minlength="1" maxlength="3" placeholder="např. 90" onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))">
					</div>
				</div>
			</div>
				<div class="mb-3">
					<label for="exampleFormControlInput1" class="form-label">Počet km</label>
					<input type="number" id="milage" name="milage" class="form-control" style="width:300px;" min = 0 max = 9999999 required minlength="1" maxlength="7" placeholder="např. 140500" onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))">
				</div>
			<br>
		</form>
	</center>
	</main>
	<br>
	<center>
	<!-- for TEST env only, comment-out before pushing to master -->
	<!-- <button type="button" class="btn btn-primary btn-sm" onclick="set_test_values()">fill values</button> -->
	<div class="login">
    <form action="{{ url_for('predict')}}"method="POST" onsubmit="return checkParametres()">
    	<input id = "car_brand_input" type = "hidden" name = "car_brand_input" value = "" />
    	<input id = "car_model_input" type = "hidden" name = "car_model_input" value = "" />
    	<input id = "car_type_input" type = "hidden" name = "car_type_input" value = "" />
    	<input id = "condition_input" type = "hidden" name = "condition_input" value = "" />
    	<input id = "service_book_input" type = "hidden" name = "service_book_input" value = "" />
    	<input id = "year_input" type = "hidden" name = "year_input" value = "" />
    	<input id = "fuell_input" type = "hidden" name = "fuell_input" value = "" />
    	<input id = "n_doors_input" type = "hidden" name = "n_doors_input" value = "" />
    	<input id = "aircondition_input" type = "hidden" name = "aircondition_input" value = "" />
    	<input id = "transmission_input" type = "hidden" name = "transmission_input" value = "" />
    	<input id = "country_input" type = "hidden" name = "country_input" value = "" />
		<input id = "engine_power_input" type = "hidden" name = "engine_power_input" value = "" />
		<input id = "milage_input" type = "hidden" name = "milage_input" value = "" />
		<button type="submit" class="btn btn-primary btn-lg" id="submitBtn" onclick="console_print()"
		style="background-color: rgb(14, 110, 143); border-color: rgb(14, 110, 143); width: 300px; font-size: 25px;">Odhadnout cenu</button>
		<br><br>
    </form>
	</div>
	</center>
	<br><br>
	<p>
		<button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample1" aria-expanded="false" aria-controls="collapseExample1" style="background-color: white; color: black; border-color: gray; text-align: left;">
			K čemu můžeme použít strojové učení?
		</button>
	  </p>
	  <div class="collapse" id="collapseExample1">
		<div class="card card-body">
			Neuronová síť aplikovaná na odhad tržní ceny automobilu je pouze jednou z mnoha efektivních a praktických použití strojového učení. 
			Strojové učení lze využít na rozpoznávání obrázků, předpovídání jakékoliv hodnoty či detekci anomálií, napodobování hlasu, apod. 
			Tyto algoritmy se umí naučit třeba i hrát počítačové hry, a to lépe než lidé. Hranici možné aplikace této technologie v současné době tvoří pouze naše představivost.<br>
		</div>
	  </div>
	<br>
	<p>
		<button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample2" aria-expanded="false" aria-controls="collapseExample2" style="background-color: white; color: black; border-color: gray; text-align: left;">
			Proč se může lišit odhad od reálné tržní ceny?
		</button>
	  </p>
	  <div class="collapse" id="collapseExample2">
		<div class="card card-body">
			Při prodeji automobilu může docházet k účelnému anebo nechtěnému pozměnění prodejní ceny oproti ceně tržní (jako např. "sleva" při využití půjčky, popřípadě očekávaný tlak na cenu ze strany zájemce). 
			Vstupní data pro neuronovou síť jsou inzeráty automobilů, které jsou vkládány autobazary, anebo lidmi postrádající potřebné znalosti k odhadnutí ceny automobilu. 
			Díky tomuto může docházet k odchylce odhadnuté ceny od skutečné tržní ceny. Tyto chyby v odhadu ceny jsou algoritmem absorbovány a naučeny, proto nelze zajistit 100% přesnost odhadu, ale předpokládaná cena bude přesto blízká reálné tržní hodnotě. 
		</div>
	  </div>
	<br>
	<p>
		<button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample3" aria-expanded="false" aria-controls="collapseExample3" style="background-color: white; color: black; border-color: gray; text-align: left;">
			Jaké jsou parametry použité Neuronové sítě?
		</button>
	  </p>
	  <div class="collapse" id="collapseExample3">
		<div class="card card-body">
			10 skrytých vrstev po 300 neuronech, l2 regularizace a velikost kroku 0.001, batch 32, gradient Adam, activační funkce ReLu, knihovna Scikit-learn MLPRegressor<br>
			Neuronová síť v tomto případě dosahuje výrazně lepších výsledků než RFR, XGBoost a ostatní regresní metody.
		</div>
	  </div>
	<br>
	<div>
		<b>
			Upozornění:
		</b>
		<br>
		<b1>
			Vypočtená cena neslouží jako referenční hodnota vozidla a její využití je pouze na vlastní odpovědnost.
		</b1>
	</div>
	<br>
	<br>
	<center>
	<address>
		© 2021 Jan Kolník <a href="mailto:jan.kolnik@gmail.com">jan.kolnik@gmail.com</a>.<br> 
	</address>
	</center>	
	</div>
</body>
	<script>
		//VARIABLES
		var car_brand
		var car_model
		var selected_element_color = "lightgreen";

		//CAR BRAND and MODEL
		var car_brand_Object = Object.keys(car_brand_model_dict);
		var select_brand_list = document.getElementById("car_brand_list");
		for(index in car_brand_Object) {
   	 		select_brand_list.options[select_brand_list.options.length] = new Option(car_brand_Object[index], index);
		}

		var select_model_list = document.getElementById("car_model_list");

		select_brand_list.addEventListener("change", function() {
			car_brand = Object.keys(car_brand_model_dict)[select_brand_list.value];
			clear_list();
			select_brand_list.style.backgroundColor = selected_element_color;
			display_car_models(car_brand);

			dataLayer.push({
				"selected_car_brand":car_brand
			});
		})

		function console_print() {
			data = passParametres(); 
			dataLayer.push({
			'test_key':'test_value',
			'car_brand': data[0],
			'car_model': data[1],
			'type': data[2],
			'service_book': data[3],
			'condition': data[4],
			'year': data[5],
			'milage': data[6],
			'engine_power': data[7],
			'fuell': data[8],
			'n_doors': data[9],
			'aircondition': data[10],
			'transmission': data[11],
			'country': data[12]});
		}

		add_listeners_color("condition");
		add_listeners_color("car_model_list");
		add_listeners_color("transmission_list")
		add_listeners_color("air_condition_list")
		add_listeners_color("country_list")
		add_listeners_color("car_type_list")
		add_listeners_color("book")
		add_listeners_color("n_doors_list")
		add_listeners_color("year")
		add_listeners_color("engine_power")
		add_listeners_color("milage")
		add_listeners_color("car_fuel_list")

		//FUEL
		load_data_to_list("car_fuel_list", fuell_data, false);

		//TRANSMISSION
		load_data_to_list("transmission_list", transmission_data, true);

		//AIRCONDITION
		load_data_to_list("air_condition_list", air_condition_data, false);

		//COUNTRY
		load_data_to_list("country_list", country_data, false);

		//CAR TYPE
		load_data_to_list("car_type_list", car_type_data, true);
	</script>
</html>